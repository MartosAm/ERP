### ================================================================
### COMPRAS A PROVEEDOR - REST Client (VS Code)
### ================================================================

@baseUrl = http://localhost:3001/api/v1/compras

### ---------------------------------------------------------------
### 1. Login Admin
### ---------------------------------------------------------------

# @name login
POST http://localhost:3001/api/v1/auth/login
Content-Type: application/json

{
  "correo": "admin@minegocio.com",
  "contrasena": "Admin12345"
}

### ---------------------------------------------------------------
### Variables
### ---------------------------------------------------------------

@token = {{login.response.body.datos.token}}

### ---------------------------------------------------------------
### 2. Crear orden de compra
### ---------------------------------------------------------------

# @name crearCompra
POST {{baseUrl}}
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "proveedorId": "REEMPLAZAR_CON_ID_PROVEEDOR",
  "numeroFactura": "FAC-2026-0042",
  "detalles": [
    {
      "productoId": "REEMPLAZAR_CON_ID_PRODUCTO",
      "cantidad": 50,
      "costoUnitario": 8.50
    },
    {
      "productoId": "REEMPLAZAR_CON_ID_PRODUCTO_2",
      "cantidad": 100,
      "costoUnitario": 3.25
    }
  ],
  "notas": "Compra mensual de insumos"
}

### ---------------------------------------------------------------
### 3. Listar compras
### ---------------------------------------------------------------

GET {{baseUrl}}?pagina=1&limite=10
Authorization: Bearer {{token}}

### ---------------------------------------------------------------
### 4. Filtrar compras pendientes (no recibidas)
### ---------------------------------------------------------------

GET {{baseUrl}}?recibida=false
Authorization: Bearer {{token}}

### ---------------------------------------------------------------
### 5. Filtrar compras recibidas
### ---------------------------------------------------------------

GET {{baseUrl}}?recibida=true
Authorization: Bearer {{token}}

### ---------------------------------------------------------------
### 6. Buscar compra
### ---------------------------------------------------------------

GET {{baseUrl}}?buscar=COMP-2026
Authorization: Bearer {{token}}

### ---------------------------------------------------------------
### 7. Detalle de compra
### ---------------------------------------------------------------

GET {{baseUrl}}/{{crearCompra.response.body.datos.id}}
Authorization: Bearer {{token}}

### ---------------------------------------------------------------
### 8. Recibir mercancia (ingresa inventario)
### ---------------------------------------------------------------

POST {{baseUrl}}/{{crearCompra.response.body.datos.id}}/recibir
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "almacenId": "REEMPLAZAR_CON_ID_ALMACEN",
  "notas": "Mercancia recibida completa, sin da√±os"
}
