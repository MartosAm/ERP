import{g as _}from"./chunk-PEWZVKZC.js";import{b as R}from"./chunk-U5BGZ5W2.js";import{a as H,b as T}from"./chunk-GZNJA4L5.js";import{a as j,c as $,d as F}from"./chunk-TIT22AFP.js";import{$ as V,_ as A,i as C,xa as z}from"./chunk-BAV5PXE6.js";import{m as P,n as B,o as D,p as k}from"./chunk-C42ID75Y.js";import{$a as a,$b as m,Db as t,Eb as e,Fa as h,Fb as g,Ob as b,Qb as M,Yb as i,Zb as s,_b as p,bc as I,ca as f,fc as o,hc as d,ia as c,mb as u,na as S,sb as E,wb as x,zb as y}from"./chunk-HI7W2E7R.js";var w=(()=>{class r{constructor(){this.api=c(C)}obtenerKPIs(){return this.api.get("reportes/dashboard")}static{this.\u0275fac=function(l){return new(l||r)}}static{this.\u0275prov=f({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function U(r,K){r&1&&(t(0,"div",4),g(1,"mat-spinner",5),e())}function q(r,K){if(r&1&&(t(0,"div",6)(1,"div",7)(2,"span",8),i(3,"Ventas hoy"),e(),t(4,"span",9),i(5),o(6,"currency"),e(),t(7,"span",10),i(8),o(9,"currency"),e()(),t(10,"div",7)(11,"span",8),i(12,"Ventas del mes"),e(),t(13,"span",9),i(14),o(15,"currency"),e(),t(16,"span",11),i(17),o(18,"number"),e()(),t(19,"div",7)(20,"span",8),i(21,"Utilidad bruta"),e(),t(22,"span",9),i(23),o(24,"currency"),e(),t(25,"span",12),i(26),o(27,"number"),e()(),t(28,"div",7)(29,"span",8),i(30,"Productos stock bajo"),e(),t(31,"span",9),i(32),e(),t(33,"span",10),i(34,"Requieren reposici\xF3n"),e()()(),t(35,"div",6)(36,"div",7)(37,"span",8),i(38,"Cotizaciones pendientes"),e(),t(39,"span",9),i(40),e(),t(41,"span",10),i(42),o(43,"currency"),e()(),t(44,"div",7)(45,"span",8),i(46,"Devoluciones (mes)"),e(),t(47,"span",9),i(48),e(),t(49,"span",10),i(50),o(51,"currency"),e()(),t(52,"div",7)(53,"span",8),i(54,"Compras del mes"),e(),t(55,"span",9),i(56),o(57,"currency"),e(),t(58,"span",10),i(59),e()(),t(60,"div",7)(61,"span",8),i(62,"Entregas pendientes"),e(),t(63,"span",9),i(64),e(),t(65,"span",10),i(66),e()()(),t(67,"div",13)(68,"div",14)(69,"span")(70,"mat-icon",15),i(71,"schedule"),e(),i(72),o(73,"date"),e(),t(74,"span")(75,"mat-icon",15),i(76,"people"),e(),i(77),e()()()),r&2){let n=M();a(5),s(d(6,26,n.data().ventasHoy.total,"$")),a(3),m(" ",n.data().ventasHoy.cantidad," \xF3rdenes \xB7 Ticket: ",d(9,29,n.data().ventasHoy.ticketPromedio,"$")," "),a(6),s(d(15,32,n.data().ventasMes.total,"$")),a(2),x("positive",n.data().ventasMes.variacionVsMesAnterior>=0)("negative",n.data().ventasMes.variacionVsMesAnterior<0),a(),m(" ",n.data().ventasMes.variacionVsMesAnterior>=0?"+":"","",d(18,35,n.data().ventasMes.variacionVsMesAnterior,"1.1-1"),"% vs mes anterior "),a(6),s(d(24,38,n.data().utilidad.utilidadBruta,"$")),a(3),p("Margen: ",d(27,41,n.data().utilidad.margenPorcentaje,"1.1-1"),"%"),a(5),x("text-red-600",n.data().productosStockBajo>0),a(),p(" ",n.data().productosStockBajo," "),a(8),s(n.data().cotizaciones.pendientes),a(2),p(" Valor: ",d(43,44,n.data().cotizaciones.valorPendiente,"$")," "),a(6),s(n.data().devoluciones.mes.cantidad),a(2),m(" ",d(51,47,n.data().devoluciones.mes.total,"$")," \xB7 Hoy: ",n.data().devoluciones.hoy.cantidad," "),a(6),s(d(57,50,n.data().comprasMes.total,"$")),a(3),p("",n.data().comprasMes.cantidad," \xF3rdenes de compra"),a(5),s(n.data().ordenesPendientesEntrega),a(2),p("Turnos abiertos: ",n.data().turnosAbiertos,""),a(6),p(" Actualizado: ",d(73,53,n.data().generadoEn,"HH:mm:ss")," "),a(5),p(" Sesiones activas: ",n.data().sesionesActivas," ")}}var ue=(()=>{class r{constructor(){this.dashSvc=c(w),this.notify=c(z),this.destroyRef=c(h),this.data=u(null),this.cargando=u(!1)}ngOnInit(){this.cargar()}cargar(){this.cargando.set(!0),this.dashSvc.obtenerKPIs().pipe(j(this.destroyRef)).subscribe({next:n=>{this.data.set(n),this.cargando.set(!1)},error:()=>{this.cargando.set(!1),this.notify.error("No se pudieron cargar los KPIs")}})}static{this.\u0275fac=function(l){return new(l||r)}}static{this.\u0275cmp=S({type:r,selectors:[["app-dashboard"]],standalone:!0,features:[I],decls:9,vars:1,consts:[[1,"page-container"],[1,"flex","items-center","justify-between","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],["mat-icon-button","","title","Actualizar",3,"click"],[1,"flex","justify-center","py-20"],["diameter","48"],[1,"kpi-grid"],[1,"kpi-card"],[1,"kpi-label"],[1,"kpi-value"],[1,"text-xs","text-gray-400"],[1,"kpi-change"],[1,"kpi-change","positive"],[1,"card","mt-4"],[1,"flex","items-center","gap-4","text-sm","text-gray-500"],[1,"text-base","align-middle"]],template:function(l,v){l&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),i(3,"Dashboard"),e(),t(4,"button",3),b("click",function(){return v.cargar()}),t(5,"mat-icon"),i(6,"refresh"),e()()(),E(7,U,2,0,"div",4)(8,q,78,56),e()),l&2&&(a(7),y(7,v.cargando()?7:v.data()?8:-1))},dependencies:[k,B,D,P,_,F,$,T,H,V,A,R]})}}return r})();export{ue as DashboardComponent};
