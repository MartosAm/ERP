import{a as j,b as p,e as U,f as V,h as m,i as l}from"./chunk-X65L4GQW.js";import{b as O,c as x,d as _,e as k,h as d,xa as z}from"./chunk-BAV5PXE6.js";import{d as F}from"./chunk-C42ID75Y.js";import{C as g,Fb as w,G as y,Na as T,S as v,aa as A,bb as R,bc as M,ca as C,db as E,fb as N,hb as D,ia as a,ib as b,lc as P,na as S,q as h,ra as I,t as f}from"./chunk-HI7W2E7R.js";var B=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=S({type:e,selectors:[["app-root"]],standalone:!0,features:[M],decls:1,vars:0,template:function(r,n){r&1&&w(0,"router-outlet")},dependencies:[j]})}}return e})();var J="@",K=(()=>{class e{constructor(o,r,n,i,s){this.doc=o,this.delegate=r,this.zone=n,this.animationType=i,this.moduleImpl=s,this._rendererFactoryPromise=null,this.scheduler=a(E,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-MK3TPC7X.js")).catch(r=>{throw new A(5300,!1)}).then(({\u0275createEngine:r,\u0275AnimationRendererFactory:n})=>{this._engine=r(this.animationType,this.doc,this.scheduler);let i=new n(this.delegate,this._engine,this.zone);return this.delegate=i,i})}createRenderer(o,r){let n=this.delegate.createRenderer(o,r);if(n.\u0275type===0)return n;typeof n.throwOnSyntheticProps=="boolean"&&(n.throwOnSyntheticProps=!1);let i=new u(n);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let Z=s.createRenderer(o,r);i.use(Z)}).catch(s=>{i.use(n)}),i}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(r){R()}}static{this.\u0275prov=C({token:e,factory:e.\u0275fac})}}return e})(),u=class{constructor(t){this.delegate=t,this.replay=[],this.\u0275type=1}use(t){if(this.delegate=t,this.replay!==null){for(let o of this.replay)o(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,o){return this.delegate.createElement(t,o)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,o){this.delegate.appendChild(t,o)}insertBefore(t,o,r,n){this.delegate.insertBefore(t,o,r,n)}removeChild(t,o,r){this.delegate.removeChild(t,o,r)}selectRootElement(t,o){return this.delegate.selectRootElement(t,o)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,o,r,n){this.delegate.setAttribute(t,o,r,n)}removeAttribute(t,o,r){this.delegate.removeAttribute(t,o,r)}addClass(t,o){this.delegate.addClass(t,o)}removeClass(t,o){this.delegate.removeClass(t,o)}setStyle(t,o,r,n){this.delegate.setStyle(t,o,r,n)}removeStyle(t,o,r){this.delegate.removeStyle(t,o,r)}setProperty(t,o,r){this.shouldReplay(o)&&this.replay.push(n=>n.setProperty(t,o,r)),this.delegate.setProperty(t,o,r)}setValue(t,o){this.delegate.setValue(t,o)}listen(t,o,r){return this.shouldReplay(o)&&this.replay.push(n=>n.listen(t,o,r)),this.delegate.listen(t,o,r)}shouldReplay(t){return this.replay!==null&&t.startsWith(J)}};function G(e="animations"){return D("NgAsyncAnimations"),I([{provide:N,useFactory:(t,o,r)=>new K(t,o,r,e),deps:[F,_,b]},{provide:T,useValue:e==="noop"?"NoopAnimations":"BrowserAnimations"}])}var L=()=>{let e=a(l),t=a(m),o=a(p);return e.estaAutenticado()?!0:(t.limpiar(),o.createUrlTree(["/auth/login"]))};function c(...e){return()=>{let t=a(l),o=a(p),r=t.usuario();return r&&e.includes(r.rol)?!0:o.createUrlTree(["/dashboard"])}}var H=[{path:"auth/login",loadComponent:()=>import("./chunk-GMEXU44G.js").then(e=>e.LoginComponent)},{path:"",canActivate:[L],loadComponent:()=>import("./chunk-XF4THD3Y.js").then(e=>e.ShellComponent),children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>import("./chunk-UYLGS52C.js").then(e=>e.DashboardComponent)},{path:"pos",loadComponent:()=>import("./chunk-YFC3IHUC.js").then(e=>e.PosComponent)},{path:"productos",loadComponent:()=>import("./chunk-AA2C7ZOT.js").then(e=>e.ProductosComponent)},{path:"inventario",loadComponent:()=>import("./chunk-FURFMYVX.js").then(e=>e.InventarioComponent)},{path:"clientes",loadComponent:()=>import("./chunk-4SQY7FQF.js").then(e=>e.ClientesComponent)},{path:"categorias",loadComponent:()=>import("./chunk-UBAUQ536.js").then(e=>e.CategoriasComponent)},{path:"proveedores",canActivate:[c("ADMIN")],loadComponent:()=>import("./chunk-TSOMOBWL.js").then(e=>e.ProveedoresComponent)},{path:"almacenes",canActivate:[c("ADMIN")],loadComponent:()=>import("./chunk-4GKCSCHM.js").then(e=>e.AlmacenesComponent)},{path:"reportes",canActivate:[c("ADMIN")],loadComponent:()=>import("./chunk-NKXKRGTK.js").then(e=>e.ReportesComponent)},{path:"configuracion",canActivate:[c("ADMIN")],loadComponent:()=>import("./chunk-R7DLI3JX.js").then(e=>e.ConfiguracionComponent)}]},{path:"**",redirectTo:"auth/login"}];var W=(e,t)=>{if(!e.url.startsWith(d.apiUrl))return t(e);let o=a(m),r=o.getToken();return r&&!o.estaExpirado()&&(e=e.clone({setHeaders:{Authorization:`Bearer ${r}`}})),t(e)};var Q=new Set([0,502,503,504]),q=new Set(["GET","HEAD","OPTIONS"]),ee=2,te=1e3,X=(e,t)=>{let o=a(m),r=a(p),n=a(z);return t(e).pipe(v({count:q.has(e.method)?ee:0,delay:(i,s)=>Q.has(i.status)?g(te*s):h(()=>i)}),y(i=>{if(e.url.startsWith(d.apiUrl))if(i.status===401)o.limpiar(),r.navigate(["/auth/login"]),n.error("Sesi\xF3n expirada. Inicia sesi\xF3n nuevamente.");else if(i.status===403)n.error("No tienes permisos para realizar esta acci\xF3n.");else if(i.status===0)n.error("Error de conexi\xF3n. Verifica tu red.");else if(i.status===429)n.error("Demasiadas solicitudes. Espera un momento.");else{let s=i.error?.mensaje||i.error?.message||"Error inesperado";n.error(s)}return h(()=>i)}))};function oe(){let e=a(l);return()=>f(e.validarSesion()).catch(()=>!1)}var Y={providers:[U(H,V()),O(x([W,X])),G(),{provide:P,useFactory:oe,multi:!0}]};k(B,Y).catch(e=>console.error(e));
